<!DOCTYPE html><head><meta charset="UTF-8"><title>UserObject System | Ferret</title><link href="../../contrib/materialize/materialize.min.css" type="text/css" rel="stylesheet" media="screen,projection"></link><link href="../../contrib/prism/prism.min.css" type="text/css" rel="stylesheet"></link><link href="../../css/moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/devel_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/alert_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/content_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/sqa_moose.css" type="text/css" rel="stylesheet"></link><link href="../../css/civet_moose.css" type="text/css" rel="stylesheet"></link><script type="text/javascript" src="../../contrib/jquery/jquery.min.js"></script></head><body><div class="page-wrap"><header><nav><div class="nav-wrapper container"><a href="../../index.html" class="left moose-logo hide-on-med-and-down" id="home-button">Ferret</a><a href="https://github.com/mangerij/ferret" class="right"><img src="../../media/framework/github-logo.png" class="github-mark"></img><img src="../../media/framework/github-mark.png" class="github-logo"></img></a><ul class="right hide-on-med-and-down"><li><a href="#!" class="dropdown-trigger" data-target="a4004388-03f5-4bdd-964e-b541d40f4637" data-constrainWidth="false">Get Started<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="7c433f3a-369d-40f5-a79c-d612a30821c1" data-constrainWidth="false">Theory<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="d2ab7111-a4a6-4f54-b692-caae0cf88dab" data-constrainWidth="false">Tutorials<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="540370d9-96ad-41bd-82f0-b11ae8d1f3cf" data-constrainWidth="false">EU Horizon2020-IF<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="../../publication_highlights/publication_highlights.html">Highlights</a></li><li><a href="#!" class="dropdown-trigger" data-target="d7c361d1-d488-4a7c-bc55-f65d05b5e3f4" data-constrainWidth="false">Documentation<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="../../contribute/index.html">Contact</a></li></ul><a href="#" class="sidenav-trigger" data-target="43acc2ef-e267-4a3f-8f71-89a494444cd0"><i class="material-icons">menu</i></a><ul class="sidenav" id="43acc2ef-e267-4a3f-8f71-89a494444cd0"><li><a href="#!" class="dropdown-trigger" data-target="25681b97-0200-42c8-b416-9b8de1e8504c" data-constrainWidth="false">Get Started<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="b63637b6-1b07-4dc6-bb65-dd06468e38de" data-constrainWidth="false">Theory<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="a26f1e91-c339-4ab6-868e-9a44648c0051" data-constrainWidth="false">Tutorials<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="d0ee265b-3dac-47cf-8fd6-986b340c5971" data-constrainWidth="false">EU Horizon2020-IF<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="../../publication_highlights/publication_highlights.html">Highlights</a></li><li><a href="#!" class="dropdown-trigger" data-target="b7068356-9daa-4777-b132-4109144ec731" data-constrainWidth="false">Documentation<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="../../contribute/index.html">Contact</a></li></ul><a href="#moose-search" class="modal-trigger"><i class="material-icons">search</i></a></div><ul class="dropdown-content" id="a4004388-03f5-4bdd-964e-b541d40f4637"><li><a href="../../getting_started/install.html">Install FERRET</a></li><li><a href="../../getting_started/update.html">Update FERRET</a></li><li><a href="../../getting_started/running.html">Running FERRET</a></li><li><a href="../../getting_started/paraview.html">Visualization Tools</a></li><li><a href="../../getting_started/docs.html">Browse the documentation locally</a></li></ul><ul class="dropdown-content" id="7c433f3a-369d-40f5-a79c-d612a30821c1"><li><a href="../../theory/intro_LGD.html">Phase Field Method of Ferroelectricity (FE)</a></li><li><a href="../../theory/intro_LLG.html">Micromagnetic Simulations</a></li><li><a href="../../theory/intro_piezo.html">Piezoelectricity</a></li><li><a href="../../theory/intro_thermo.html">Thermoelectric Phenomena</a></li><li><a href="../../theory/intro_optical.html">Optical Properties</a></li></ul><ul class="dropdown-content" id="d2ab7111-a4a6-4f54-b692-caae0cf88dab"><li><a href="../../tutorials/FE_phase_field_multi_domain.html">Multidomain ferroelectric</a></li><li><a href="../../tutorials/ferroelectric_domain_wall.html">Ferroelectric domain wall</a></li><li><a href="../../tutorials/FE_phase_field_multi_domain_coupled.html">Ferroelectric thin film</a></li><li><a href="../../tutorials/magnetic_ringdown.html">Magnetic ringdown</a></li><li><a href="../../tutorials/AFM_dynamics.html">Antiferromagnetic dynamics</a></li><li><a href="../../tutorials/piezoelectric.html">Piezoelectric actuation</a></li><li><a href="../../tutorials/thermoelectric.html">Polycrystalline thermoelectric transport</a></li></ul><ul class="dropdown-content" id="540370d9-96ad-41bd-82f0-b11ae8d1f3cf"><li><a href="../../MSCA_EU_Horizon2020_Results/horizon2020_results1.html">Background and model</a></li><li><a href="../../MSCA_EU_Horizon2020_Results/horizon2020_results2.html">Summary of key results</a></li><li><a href="../../MSCA_EU_Horizon2020_Results/horizon2020_ex1.html">Example (ground states)</a></li><li><a href="../../MSCA_EU_Horizon2020_Results/horizon2020_ex2.html">Example (FE DWs)</a></li><li><a href="../../MSCA_EU_Horizon2020_Results/horizon2020_ex3.html">Example (magnetic DWs)</a></li><li><a href="../../MSCA_EU_Horizon2020_Results/horizon2020_ex4.html">Example (ME switching)</a></li><li><a href="../../MSCA_EU_Horizon2020_Results/horizon2020_ex5.html">Example (spin wave transport)</a></li></ul><ul class="dropdown-content" id="d7c361d1-d488-4a7c-bc55-f65d05b5e3f4"><li><a href="../index.html">Complete syntax</a></li><li><a href="../ferret_only_syntax.html">FERRET syntax</a></li></ul><ul class="dropdown-content" id="25681b97-0200-42c8-b416-9b8de1e8504c"><li><a href="../../getting_started/install.html">Install FERRET</a></li><li><a href="../../getting_started/update.html">Update FERRET</a></li><li><a href="../../getting_started/running.html">Running FERRET</a></li><li><a href="../../getting_started/paraview.html">Visualization Tools</a></li><li><a href="../../getting_started/docs.html">Browse the documentation locally</a></li></ul><ul class="dropdown-content" id="b63637b6-1b07-4dc6-bb65-dd06468e38de"><li><a href="../../theory/intro_LGD.html">Phase Field Method of Ferroelectricity (FE)</a></li><li><a href="../../theory/intro_LLG.html">Micromagnetic Simulations</a></li><li><a href="../../theory/intro_piezo.html">Piezoelectricity</a></li><li><a href="../../theory/intro_thermo.html">Thermoelectric Phenomena</a></li><li><a href="../../theory/intro_optical.html">Optical Properties</a></li></ul><ul class="dropdown-content" id="a26f1e91-c339-4ab6-868e-9a44648c0051"><li><a href="../../tutorials/FE_phase_field_multi_domain.html">Multidomain ferroelectric</a></li><li><a href="../../tutorials/ferroelectric_domain_wall.html">Ferroelectric domain wall</a></li><li><a href="../../tutorials/FE_phase_field_multi_domain_coupled.html">Ferroelectric thin film</a></li><li><a href="../../tutorials/magnetic_ringdown.html">Magnetic ringdown</a></li><li><a href="../../tutorials/AFM_dynamics.html">Antiferromagnetic dynamics</a></li><li><a href="../../tutorials/piezoelectric.html">Piezoelectric actuation</a></li><li><a href="../../tutorials/thermoelectric.html">Polycrystalline thermoelectric transport</a></li></ul><ul class="dropdown-content" id="d0ee265b-3dac-47cf-8fd6-986b340c5971"><li><a href="../../MSCA_EU_Horizon2020_Results/horizon2020_results1.html">Background and model</a></li><li><a href="../../MSCA_EU_Horizon2020_Results/horizon2020_results2.html">Summary of key results</a></li><li><a href="../../MSCA_EU_Horizon2020_Results/horizon2020_ex1.html">Example (ground states)</a></li><li><a href="../../MSCA_EU_Horizon2020_Results/horizon2020_ex2.html">Example (FE DWs)</a></li><li><a href="../../MSCA_EU_Horizon2020_Results/horizon2020_ex3.html">Example (magnetic DWs)</a></li><li><a href="../../MSCA_EU_Horizon2020_Results/horizon2020_ex4.html">Example (ME switching)</a></li><li><a href="../../MSCA_EU_Horizon2020_Results/horizon2020_ex5.html">Example (spin wave transport)</a></li></ul><ul class="dropdown-content" id="b7068356-9daa-4777-b132-4109144ec731"><li><a href="../index.html">Complete syntax</a></li><li><a href="../ferret_only_syntax.html">FERRET syntax</a></li></ul></nav><div class="modal modal-fixed-footer moose-search-modal" id="moose-search"><div class="modal-content container moose-search-modal-content"><div class="gcse-search"></div></div><div class="modal-footer"><a href="#!" class="modal-close btn-flat">Close</a></div></div></header><main class="main"><div class="container"><div class="row"><div class="moose-content col s12 m12 l12"><section id="1c247920-7f3a-440e-9daf-2d37f2047c64" data-section-level="1" data-section-text="UserObject System"><h1 id="userobject-system">UserObject System</h1><p>The UserObject system is developing and running custom algorithms that may not fit well within any other system in MOOSE. Examples include complex calculations that may result values that don&#x27;t associate in a one to one manner with elements, nodes, or sides. Perhaps your user object produces values based on height in your domain or based on groups of related elements (not necessarily associated with subdomains or other static mesh features). Often these calculations may result in custom data structures that can be managed by the developer.</p><p>The UserObject system is the basis for the <a href="../Postprocessors/index.html">Postprocessor</a> system. The only difference being that Postprocessors have an additional interface for returning values and corresponding managed storage within the framework for retrieving those values through well-defined interfaces \(<a href="../../source/interfaces/PostprocessorInterface.html">PostprocessorInterface</a>\).</p><section id="84ebb08e-3a9c-4203-aed2-0288c8e88950" data-section-level="2" data-section-text="User - defined APIs"><h2 id="user-defined-apis">User-defined APIs</h2><p>One benefit of the UserObject system is that it is designed with user-defined APIs in mind. UserObjects can and should define additional <code>public</code> methods that may be used to retrieve data computed by the UserObject. The <a href="../../source/interfaces/UserObjectInterface.html">UserObjectInterface</a> is templated so that an object that depends on a specific type of UserObject may retrieve that specific type of UserObject and use the interface without the use of dynamic casts.</p></section><section id="714c195b-1f2f-48e4-beb7-90d1a6b48030" data-section-level="2" data-section-text="Types of UserObjects"><h2 id="types-of-userobjects">Types of UserObjects</h2><ul class="browser-default"><li><p><strong>GeneralUserObject</strong>: &quot;execute&quot; is called once on each execution flag. </p></li><li><p><strong>NodalUserObject</strong>: &quot;execute&quot; is called for each <strong>node</strong> within the mesh on each execution flag. </p></li><li><p><strong>ElementalUserObject</strong>: &quot;execute&quot; is called for each <strong>element</strong> within the mesh on each execution  flag. </p></li><li><p><strong>InternalSideUserObject</strong>: &quot;execute&quot; is called for each <strong>side</strong>, that is not on a boundary,  within the mesh on each execution flag. </p></li><li><p><strong>SideUserObject</strong>: &quot;execute&quot; is called for each <strong>side</strong>, that is on a boundary, within the mesh  on each execution flag. If the boundary is internal within the mesh, only variables, material  properties, etc. at the primal side of the boundary are available. </p></li><li><p><strong>InterfaceUserObject</strong>: &quot;execute&quot; is called for each <strong>side</strong>, that is on an internal boundary,  within the mesh on each execution flag. Variables, material properties, etc. at both the primary  and the secondary side of the internal boundary are available. </p></li><li><p><strong>DomainUserObject</strong>: this object is capable of executing all the operations of a <strong>ElementUserObject</strong>, <strong>InternalSideUserObject</strong>, <strong>SideUserObject</strong> and <strong>InterfaceUserObject</strong>. </p></li><li><p><strong>MortarUserObject</strong>: &quot;execute&quot; is called for each mortar segment element corresponding to the secondary-primary mortar interface pairing on each execution flag</p></li></ul></section></section><section id="9d46eb1a-4683-421d-ae15-39e5b68629b6" data-section-level="1" data-section-text="Execution order"><h1 id="execution-order">Execution order</h1><p>Within an execution stage set by the <a href="../../source/interfaces/SetupInterface.html"><code>execute_on</code></a> parameter, user objects are executed in the following order:</p><ol class="browser-default" start="1"><li><p><code>residualSetup</code> / <code>jacobianSetup</code></p><p>If the current <code>execute_on</code> flag is either <code>EXEC_LINEAR</code> or <code>EXEC_NONLINEAR</code> the <code>residualSetup</code> and <code>jacobianSetup</code> are called respectively in the following order</p><ol class="browser-default" start="1"><li><p>for objects derived from <code>ElementUserObject</code>,  <code>SideUserObject</code>, <code>InternalSideUserObject</code> <code>InterfaceUserObject</code>, and  <code>DomainUserObject</code>. </p></li><li><p>for objects derived from <code>NodalUserObject</code>. </p></li><li><p>for objects derived from <code>ThreadedGeneralUserObject</code>. </p></li><li><p>for objects derived from <code>GeneralUserObject</code>.</p></li></ol><p></p></li><li><p><code>initialize</code> is called for objects derived from <code>ElementUserObject</code>,  <code>SideUserObject</code>, <code>InternalSideUserObject</code> <code>InterfaceUserObject</code>, and  <code>DomainUserObject</code> in that order.</p><p></p></li><li><p>All active local elements are iterated over and objects derived from <code>ElementUserObject</code>, <code>SideUserObject</code>, <code>InternalSideUserObject</code> <code>InterfaceUserObject</code>, and  <code>DomainUserObject</code> are executed on elements, boundaries attached to the element, internal sides between elements, and on subdomain changes, in that order. The order within each type group is determined through dependency resolution.</p><p></p></li><li><p><code>threadJoin</code> and <code>finalize</code> are called in the following order</p><ol class="browser-default" start="1"><li><p>for objects derived from <code>SideUserObject</code> </p></li><li><p>for objects derived from <code>InternalSideUserObject</code> </p></li><li><p>for objects derived from <code>InterfaceUserObject</code> </p></li><li><p>for objects derived from <code>ElementUserObject</code> </p></li><li><p>for objects derived from <code>DomainUserObject</code></p></li></ol><p></p></li><li><p><code>initialize</code> is called for objects derived from <code>NodalUserObject</code>.</p><p></p></li><li><p><code>NodalUserObject</code> are looped over all local nodes and executed on each node. On each node, the order is determined through dependency resolution.</p><p></p></li><li><p><code>threadJoin</code> and <code>finalize</code> are called for <code>NodalUserObject</code>s.</p><p></p></li><li><p><code>initialize</code> is called for objects derived from <code>ThreadedGeneralUserObject</code>.</p><p></p></li><li><p><code>execute</code> is called for objects derived from <code>ThreadedGeneralUserObject</code> in a threaded way.</p><p></p></li><li><p><code>threadJoin</code> and <code>finalize</code> ar called for <code>ThreadedGeneralUserObject</code>s.</p><p></p></li><li><p><code>initialize</code>, <code>execute</code>, and <code>finalize</code> are called in that order for each <code>GeneralUserObject</code> (which in turn are ordered through dependency resolution within the set of applicable <code>GeneralUserObject</code>s).</p></li></ol><p>For additional control over the user object execution order every user object has a <code>execution_order_group</code> parameter of type integer. This parameter can be used to force multiple execution rounds of the above order, so it effectively supersedes all the ordering described above. All objects with the same <code>execution_order_group</code> parameter value are executed in the same round, and groups with a lower number are executed first. The default <code>execution_order_group</code> is 0 (zero). Negative values can be specified to force user object execution <em>before</em> the default group, and positive values can be uses to create execution groups that run <em>after</em> the default group. Execution order groups apply to all <code>execute_on</code> flags specified for a given object.</p><section id="d772ba69-2a49-47e3-a220-266274d25b63" data-section-level="2" data-section-text="Restartable Data"><h2 id="restartable-data">Restartable Data</h2><p>Since UserObjects often create and store large data structures, the developer of a UserObject should consider whether or not those data structures needs to be declared as &quot;restartable&quot;. Knowing whether or not a data structure should be declared restartable is straight-forward: If the information in a data structure is expected to persist across time steps, it <strong>must</strong> be declared as restartable. Conversely, if the data in a data structure is recomputed at each invocation of the UserObject, no action is necessary. See restart_recover.md for more information. </p></section></section></div></div></div></main></div></body><script type="text/javascript" src="../../contrib/materialize/materialize.min.js"></script><script type="text/javascript" src="../../contrib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="../../contrib/prism/prism.min.js"></script><script type="text/javascript" src="../../js/init.js"></script><script type="text/javascript" src="../../js/navigation.js"></script><script type="text/javascript" src="https://cse.google.com/cse.js?cx=008852834041008754713:g3ilnhhbbj9"></script><script type="text/javascript" src="../../js/sqa_moose.js"></script>