<!DOCTYPE html><head><meta charset="UTF-8"><title>Use Maximal Poisson Disk Sampling MPS to generate grain centroids | Ferret</title><link href="../../../contrib/materialize/materialize.min.css" type="text/css" rel="stylesheet" media="screen,projection"></link><link href="../../../contrib/prism/prism.min.css" type="text/css" rel="stylesheet"></link><link href="../../../css/moose.css" type="text/css" rel="stylesheet"></link><link href="../../../css/devel_moose.css" type="text/css" rel="stylesheet"></link><link href="../../../css/alert_moose.css" type="text/css" rel="stylesheet"></link><link href="../../../css/content_moose.css" type="text/css" rel="stylesheet"></link><link href="../../../css/sqa_moose.css" type="text/css" rel="stylesheet"></link><link href="../../../css/civet_moose.css" type="text/css" rel="stylesheet"></link><script type="text/javascript" src="../../../contrib/jquery/jquery.min.js"></script></head><body><div class="page-wrap"><header><nav><div class="nav-wrapper container"><a href="../../../index.html" class="left moose-logo hide-on-med-and-down" id="home-button">Ferret</a><a href="https://github.com/mangerij/ferret" class="right"><img src="../../../media/framework/github-logo.png" class="github-mark"></img><img src="../../../media/framework/github-mark.png" class="github-logo"></img></a><ul class="right hide-on-med-and-down"><li><a href="#!" class="dropdown-trigger" data-target="07bf6d98-9daf-43f8-8830-aa5343dab6d4" data-constrainWidth="false">Get Started<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="4c33472d-4833-45b3-bb66-5a1bd8a808b7" data-constrainWidth="false">Theory<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="90beec95-261f-44bd-81ee-8def71127c8f" data-constrainWidth="false">Tutorials<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="0e9b1b38-68c4-487d-9dd6-ff404603815e" data-constrainWidth="false">EU Horizon2020-IF<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="../../../publication_highlights/publication_highlights.html">Highlights</a></li><li><a href="#!" class="dropdown-trigger" data-target="e5598502-5579-400a-a45d-157ee17f9d1f" data-constrainWidth="false">Documentation<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="../../../contribute/index.html">Contact</a></li></ul><a href="#" class="sidenav-trigger" data-target="40c4404b-7161-46e9-9480-5be67cc14f3c"><i class="material-icons">menu</i></a><ul class="sidenav" id="40c4404b-7161-46e9-9480-5be67cc14f3c"><li><a href="#!" class="dropdown-trigger" data-target="4498642b-9c00-4230-b521-18d3e6dcd710" data-constrainWidth="false">Get Started<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="cbec37c0-975a-4e29-b7d1-f5776536386f" data-constrainWidth="false">Theory<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="35a0284b-f094-4e43-9270-efd50e8dcadb" data-constrainWidth="false">Tutorials<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="#!" class="dropdown-trigger" data-target="8c4aa797-c722-41e1-9c99-3eb1986cb68c" data-constrainWidth="false">EU Horizon2020-IF<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="../../../publication_highlights/publication_highlights.html">Highlights</a></li><li><a href="#!" class="dropdown-trigger" data-target="b26b3a1a-e7ec-4a2b-8b84-10705db9b158" data-constrainWidth="false">Documentation<i class="material-icons right">arrow_drop_down</i></a></li><li><a href="../../../contribute/index.html">Contact</a></li></ul><a href="#moose-search" class="modal-trigger"><i class="material-icons">search</i></a></div><ul class="dropdown-content" id="07bf6d98-9daf-43f8-8830-aa5343dab6d4"><li><a href="../../../getting_started/install.html">Install FERRET</a></li><li><a href="../../../getting_started/update.html">Update FERRET</a></li><li><a href="../../../getting_started/running.html">Running FERRET</a></li><li><a href="../../../getting_started/paraview.html">Visualization Tools</a></li><li><a href="../../../getting_started/docs.html">Browse the documentation locally</a></li></ul><ul class="dropdown-content" id="4c33472d-4833-45b3-bb66-5a1bd8a808b7"><li><a href="../../../theory/intro_LGD.html">Phase Field Method of Ferroelectricity (FE)</a></li><li><a href="../../../theory/intro_LLG.html">Micromagnetic Simulations</a></li><li><a href="../../../theory/intro_piezo.html">Piezoelectricity</a></li><li><a href="../../../theory/intro_thermo.html">Thermoelectric Phenomena</a></li><li><a href="../../../theory/intro_optical.html">Optical Properties</a></li></ul><ul class="dropdown-content" id="90beec95-261f-44bd-81ee-8def71127c8f"><li><a href="../../../tutorials/FE_phase_field_multi_domain.html">Multidomain ferroelectric</a></li><li><a href="../../../tutorials/ferroelectric_domain_wall.html">Ferroelectric domain wall</a></li><li><a href="../../../tutorials/FE_phase_field_multi_domain_coupled.html">Ferroelectric thin film</a></li><li><a href="../../../tutorials/magnetic_ringdown.html">Magnetic ringdown</a></li><li><a href="../../../tutorials/AFM_dynamics.html">Antiferromagnetic dynamics</a></li><li><a href="../../../tutorials/piezoelectric.html">Piezoelectric actuation</a></li><li><a href="../../../tutorials/thermoelectric.html">Polycrystalline thermoelectric transport</a></li></ul><ul class="dropdown-content" id="0e9b1b38-68c4-487d-9dd6-ff404603815e"><li><a href="../../../MSCA_EU_Horizon2020_Results/horizon2020_results1.html">Background and model</a></li><li><a href="../../../MSCA_EU_Horizon2020_Results/horizon2020_results2.html">Summary of key results</a></li><li><a href="../../../MSCA_EU_Horizon2020_Results/horizon2020_ex1.html">Example (ground states)</a></li><li><a href="../../../MSCA_EU_Horizon2020_Results/horizon2020_ex2.html">Example (FE DWs)</a></li><li><a href="../../../MSCA_EU_Horizon2020_Results/horizon2020_ex3.html">Example (magnetic DWs)</a></li><li><a href="../../../MSCA_EU_Horizon2020_Results/horizon2020_ex4.html">Example (ME switching)</a></li><li><a href="../../../MSCA_EU_Horizon2020_Results/horizon2020_ex5.html">Example (spin wave transport)</a></li></ul><ul class="dropdown-content" id="e5598502-5579-400a-a45d-157ee17f9d1f"><li><a href="../../../syntax/index.html">Complete syntax</a></li><li><a href="../../../syntax/ferret_only_syntax.html">FERRET syntax</a></li></ul><ul class="dropdown-content" id="4498642b-9c00-4230-b521-18d3e6dcd710"><li><a href="../../../getting_started/install.html">Install FERRET</a></li><li><a href="../../../getting_started/update.html">Update FERRET</a></li><li><a href="../../../getting_started/running.html">Running FERRET</a></li><li><a href="../../../getting_started/paraview.html">Visualization Tools</a></li><li><a href="../../../getting_started/docs.html">Browse the documentation locally</a></li></ul><ul class="dropdown-content" id="cbec37c0-975a-4e29-b7d1-f5776536386f"><li><a href="../../../theory/intro_LGD.html">Phase Field Method of Ferroelectricity (FE)</a></li><li><a href="../../../theory/intro_LLG.html">Micromagnetic Simulations</a></li><li><a href="../../../theory/intro_piezo.html">Piezoelectricity</a></li><li><a href="../../../theory/intro_thermo.html">Thermoelectric Phenomena</a></li><li><a href="../../../theory/intro_optical.html">Optical Properties</a></li></ul><ul class="dropdown-content" id="35a0284b-f094-4e43-9270-efd50e8dcadb"><li><a href="../../../tutorials/FE_phase_field_multi_domain.html">Multidomain ferroelectric</a></li><li><a href="../../../tutorials/ferroelectric_domain_wall.html">Ferroelectric domain wall</a></li><li><a href="../../../tutorials/FE_phase_field_multi_domain_coupled.html">Ferroelectric thin film</a></li><li><a href="../../../tutorials/magnetic_ringdown.html">Magnetic ringdown</a></li><li><a href="../../../tutorials/AFM_dynamics.html">Antiferromagnetic dynamics</a></li><li><a href="../../../tutorials/piezoelectric.html">Piezoelectric actuation</a></li><li><a href="../../../tutorials/thermoelectric.html">Polycrystalline thermoelectric transport</a></li></ul><ul class="dropdown-content" id="8c4aa797-c722-41e1-9c99-3eb1986cb68c"><li><a href="../../../MSCA_EU_Horizon2020_Results/horizon2020_results1.html">Background and model</a></li><li><a href="../../../MSCA_EU_Horizon2020_Results/horizon2020_results2.html">Summary of key results</a></li><li><a href="../../../MSCA_EU_Horizon2020_Results/horizon2020_ex1.html">Example (ground states)</a></li><li><a href="../../../MSCA_EU_Horizon2020_Results/horizon2020_ex2.html">Example (FE DWs)</a></li><li><a href="../../../MSCA_EU_Horizon2020_Results/horizon2020_ex3.html">Example (magnetic DWs)</a></li><li><a href="../../../MSCA_EU_Horizon2020_Results/horizon2020_ex4.html">Example (ME switching)</a></li><li><a href="../../../MSCA_EU_Horizon2020_Results/horizon2020_ex5.html">Example (spin wave transport)</a></li></ul><ul class="dropdown-content" id="b26b3a1a-e7ec-4a2b-8b84-10705db9b158"><li><a href="../../../syntax/index.html">Complete syntax</a></li><li><a href="../../../syntax/ferret_only_syntax.html">FERRET syntax</a></li></ul></nav><div class="modal modal-fixed-footer moose-search-modal" id="moose-search"><div class="modal-content container moose-search-modal-content"><div class="gcse-search"></div></div><div class="modal-footer"><a href="#!" class="modal-close btn-flat">Close</a></div></div></header><main class="main"><div class="container"><div class="row"><div class="moose-content col s12 m12 l12"><section id="45a3feaf-0086-4706-a862-f565c4a316a2" data-section-level="1" data-section-text="Use Maximal Poisson - Disk Sampling ( MPS ) to generate grain centroids"><h1 id="use-maximal-poisson-disk-sampling-mps-to-generate-grain-centroids">Use Maximal Poisson-Disk Sampling (MPS) to generate grain centroids</h1><p>Random close-packing (RCP) structure can be realized by a spatial sampling process known as Maximal Poisson-Disk Sampling (MPS). For the RCP structure, the average aspect ratio of each Voronoi cell is approximately one. The RCP Voronoi structure provides an equiaxed grain structure.</p><p>The MPS algorithm is described in <a href="#Ebeida_2012">Ebeida et al. (2012)</a> and it is implemented in <a href="https://github.com/trilinos/Trilinos/tree/master/packages/meshinggenie">MeshingGenie</a> package in <a href="https://trilinos.org">Trilinos</a>. MeshingGenie will generate a list of grain centroids as a text file that can then be read into the PolycrystalVoronoi initial condition.</p><section id="2b8eb8d5-5555-43e8-be0b-c5033c38c803" data-section-level="2" data-section-text="Build instruction for standalone version of MeshingGenie"><h2 id="build-instruction-for-standalone-version-of-meshinggenie">Build instruction for standalone version of MeshingGenie</h2><ul class="browser-default"><li><p>Download release version of <a href="https://github.com/trilinos/Trilinos/releases/tag/trilinos-release-12-12-1">Trilinos</a> (Note: please do not git clone!) </p></li><li><p>Run <code>cmake .</code> in the Trilinos/packages/meshinggenie/src/standalone/ directory </p></li><li><p>Run <code>make</code>. Executable file named MeshingGenie is located in the Trilinos/packages/meshinggenie/src/standalone/app directory</p></li></ul></section><section id="78da32bd-c1ec-4206-894d-3029aca2ae20" data-section-level="2" data-section-text="Run MeshingGenie to generate the centroids of grains"><h2 id="run-meshinggenie-to-generate-the-centroids-of-grains">Run MeshingGenie to generate the centroids of grains</h2><p>To run MeshingGenie, type <code>./MeshingGenie input.dat</code>. In the input file <code>input.dat</code>, the first line is &quot;p&quot;, which indicates MPS. The second line should be in the format of &quot;D R S N_bp N_bf&quot;, where D is the dimension, R the distribution radius, S the random seed, N_bp the number of boundary points and N_bf the number of boundary faces. The next N_bp lines are the x, y, and z of the boundary points in order. Each entry of the next N_bf lines describes a triangularized boundary face using the indices of the boundary points listed in an ordered direction (outwards normal using the right hand rule).</p><p>An example of 2d input file <code>2d.dat</code> is given below</p><pre class="moose-pre"><code class="language-text">
p
2 0.3 10 4 4
0 0
1 0
1 1
0 1
0 1
1 2
2 3
3 0
</code></pre><p>and 3d input file <code>3d.dat</code> is given below</p><pre class="moose-pre"><code class="language-text">
p
3 0.3 10 8 12
0 0 0
1 0 0
1 1 0
0 1 0
0 0 1
1 0 1
1 1 1
0 1 1
0 3 2
0 2 1
1 2 5
2 6 5
0 1 5
0 5 4
0 4 3
3 4 7
3 7 6
3 6 2
5 6 7
5 7 4
</code></pre><p>The output file containing centroids is stored in <code>maximal_sample.dat</code>. The first line contains the dimension, distribution radius and number of grains. An example of output file <code>maximal_sample.dat</code> is given below</p><pre class="moose-pre"><code class="language-text">
2 0.3 5
0.232307832746474 0.452347042281606
0.310283982183736 0.848418291915013
0.561253436179246 0.534434874769859
0.665658262188368 0.214715684556803
0.714381419175506 0.826132085262111
</code></pre></section><section id="c5e3c117-0e5a-43f9-a625-30a061e5a3e6" data-section-level="2" data-section-text="Use the centroids to generate Voronoi tessellation in Phase field"><h2 id="use-the-centroids-to-generate-voronoi-tessellation-in-phase-field">Use the centroids to generate Voronoi tessellation in Phase field</h2><p>The <a href="../../../source/userobjects/PolycrystalVoronoi.html"><code>PolycrystalVoronoi</code></a> can read grain centroids from a text file and performs a Voronoi tesslation to produce a grain structure. The syntax is</p><pre class="moose-pre"><code class="language-text">
[UserObjects]
  [./voronoi]
    type = PolycrystalVoronoi
    grain_num = 5
    file_name = &#x27;grains.txt&#x27;
  [../]
[]
</code></pre><p>The <code>grains.txt</code> contains the grain centroids that can be taken from <code>maximal_sample.dat</code>. An example of text file <code>grains.txt</code> is given below</p><pre class="moose-pre"><code class="language-text">
x                 y
0.232307832746474 0.452347042281606
0.310283982183736 0.848418291915013
0.561253436179246 0.534434874769859
0.665658262188368 0.214715684556803
0.714381419175506 0.826132085262111
</code></pre></section><section id="968c283a-7dbc-4d03-8a0b-368adb5454da" data-section-level="2" data-section-text="References"><h2 id="references">References</h2><div class="moose-bibliography"><ol><li id="Ebeida_2012">Mohamed&nbsp;S. Ebeida, Scott&nbsp;A. Mitchell, Anjul Patney, Andrew&nbsp;A. Davidson, and John&nbsp;D. Owens.
A simple algorithm for maximal poisson-disk sampling in high dimensions.
<em>Comput. Graph. Forum</em>, 31(2pt4):785â€“794, May 2012.
URL: <a href="http://dx.doi.org/10.1111/j.1467-8659.2012.03059.x">http://dx.doi.org/10.1111/j.1467-8659.2012.03059.x</a>, <a href="https://doi.org/10.1111/j.1467-8659.2012.03059.x">doi:10.1111/j.1467-8659.2012.03059.x</a>.<a href="#9e74ed5b-0d91-4ac8-a95e-767f08f67092" class="modal-trigger moose-bibtex-modal" style="padding-left:10px;">[BibTeX]</a><div class="modal" id="9e74ed5b-0d91-4ac8-a95e-767f08f67092"><div class="modal-content"><pre style="line-height:1.25;"><code class="language-latex">@article{Ebeida_2012,
    author = "Ebeida, Mohamed S. and Mitchell, Scott A. and Patney, Anjul and Davidson, Andrew A. and Owens, John D.",
    title = "A Simple Algorithm for Maximal Poisson-Disk Sampling in High Dimensions",
    journal = "Comput. Graph. Forum",
    issue_date = "May 2012",
    volume = "31",
    number = "2pt4",
    month = "May",
    year = "2012",
    issn = "0167-7055",
    pages = "785--794",
    numpages = "10",
    url = "http://dx.doi.org/10.1111/j.1467-8659.2012.03059.x",
    doi = "10.1111/j.1467-8659.2012.03059.x",
    acmid = "2322144",
    publisher = "The Eurographs Association \\&\\#38; John Wiley \\&\\#38; Sons, Ltd.",
    address = "Chichester, UK",
    keywords = "Computing Methodologies [I.3.5]: Computer Graphics\\&\\#x2014;Computational Geometry and Object Modeling"
}
</code></pre></div></div></li></ol></div><p></p></section></section></div></div></div></main></div></body><script type="text/javascript" src="../../../contrib/materialize/materialize.min.js"></script><script type="text/javascript" src="../../../contrib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="../../../contrib/prism/prism.min.js"></script><script type="text/javascript" src="../../../js/init.js"></script><script type="text/javascript" src="../../../js/navigation.js"></script><script type="text/javascript" src="https://cse.google.com/cse.js?cx=008852834041008754713:g3ilnhhbbj9"></script><script type="text/javascript" src="../../../js/sqa_moose.js"></script>